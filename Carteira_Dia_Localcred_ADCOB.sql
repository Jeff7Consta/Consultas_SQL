IF OBJECT_ID('tempdb..##CODEMPRESA') IS NOT NULL DROP TABLE ##CODEMPRESA
IF OBJECT_ID('tempdb..##CODDEPARA') IS NOT NULL DROP TABLE ##CODDEPARA
IF OBJECT_ID('tempdb..##CARGA_GERAL') IS NOT NULL DROP TABLE ##CARGA_GERAL
IF OBJECT_ID('tempdb..##FXDIAL_TEL') IS NOT NULL DROP TABLE ##FXDIAL_TEL
IF OBJECT_ID('tempdb..##DIAL') IS NOT NULL DROP TABLE ##DIAL


SELECT CODEMPRESA, NOMEMPRESA INTO ##CODDEPARA FROM ADCOBDAT..AD002
WHERE CODEMPRESA IN ('41001',
'61001',
'46001',
'46002',
'46003',
'46004',
'46005',
'46006',
'25020',
'5001',
'5001',
'67001',
'57001',
'57002',
'72001',
'73001',
'70001',
'70002',
'70003',
'75001',
'28010',
'71001',
'71002',
'53001',
'53005',
'53006',
'53007',
'53008',
'53009',
'53010',
'53011',
'53012',
'53013',
'66001',
'66002',
'6001',
'6006',
'6010',
'53002',
'53003',
'59001',
'3001',
'3002',
'3003',
'3010')


SELECT 
A.CODEMPRESA, 
B.NOMEMPRESA,
COUNT(A.NUMCONTRDIV)  AS Quantidade_Contrato,
Count(Distinct(A.CODCPFCNPJCLI)) AS Quantidade_CPF
FROM ADCOBDAT..VW_CARTEIRACOBRANCA A WITH (NOLOCK)
INNER JOIN ##CODDEPARA B ON A.CODEMPRESA = B.CODEMPRESA

GROUP BY 
A.CODEMPRESA, 
B.NOMEMPRESA
  